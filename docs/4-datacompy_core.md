# Datacompy Core

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-datacompy.core.render-start--->
## [datacompy.core.render](4-datacompy_core.md#datacompy.core.render)

<!---Documatic-section-render-start--->
<!---Documatic-block-datacompy.core.render-start--->
<details>
	<summary><code>datacompy.core.render</code> code snippet</summary>

```python
def render(filename, *fields):
    this_dir = os.path.dirname(os.path.realpath(__file__))
    with open(os.path.join(this_dir, 'templates', filename)) as file_open:
        return file_open.read().format(*fields)
```
</details>
<!---Documatic-block-datacompy.core.render-end--->
<!---Documatic-section-render-end--->

# #
<!---Documatic-section-datacompy.core.render-end--->

<!---Documatic-section-datacompy.core.columns_equal-start--->
## [datacompy.core.columns_equal](4-datacompy_core.md#datacompy.core.columns_equal)

<!---Documatic-section-columns_equal-start--->
```mermaid
flowchart LR
datacompy.core.columns_equal-->datacompy.core.compare_string_and_date_columns
```

### Object Calls

* [datacompy.core.compare_string_and_date_columns](4-datacompy_core.md#datacompy.core.compare_string_and_date_columns)

<!---Documatic-block-datacompy.core.columns_equal-start--->
<details>
	<summary><code>datacompy.core.columns_equal</code> code snippet</summary>

```python
def columns_equal(col_1, col_2, rel_tol=0, abs_tol=0, ignore_spaces=False, ignore_case=False):
    try:
        compare = pd.Series(np.isclose(col_1, col_2, rtol=rel_tol, atol=abs_tol, equal_nan=True))
    except TypeError:
        try:
            compare = pd.Series(np.isclose(col_1.astype(float), col_2.astype(float), rtol=rel_tol, atol=abs_tol, equal_nan=True))
        except (ValueError, TypeError):
            try:
                if ignore_spaces:
                    if col_1.dtype.kind == 'O':
                        col_1 = col_1.str.strip()
                    if col_2.dtype.kind == 'O':
                        col_2 = col_2.str.strip()
                if ignore_case:
                    if col_1.dtype.kind == 'O':
                        col_1 = col_1.str.upper()
                    if col_2.dtype.kind == 'O':
                        col_2 = col_2.str.upper()
                if {col_1.dtype.kind, col_2.dtype.kind} == {'M', 'O'}:
                    compare = compare_string_and_date_columns(col_1, col_2)
                else:
                    compare = pd.Series((col_1 == col_2) | col_1.isnull() & col_2.isnull())
            except:
                compare = pd.Series(False, index=col_1.index)
    compare.index = col_1.index
    return compare
```
</details>
<!---Documatic-block-datacompy.core.columns_equal-end--->
<!---Documatic-section-columns_equal-end--->

# #
<!---Documatic-section-datacompy.core.columns_equal-end--->

<!---Documatic-section-datacompy.core.compare_string_and_date_columns-start--->
## [datacompy.core.compare_string_and_date_columns](4-datacompy_core.md#datacompy.core.compare_string_and_date_columns)

<!---Documatic-section-compare_string_and_date_columns-start--->
<!---Documatic-block-datacompy.core.compare_string_and_date_columns-start--->
<details>
	<summary><code>datacompy.core.compare_string_and_date_columns</code> code snippet</summary>

```python
def compare_string_and_date_columns(col_1, col_2):
    if col_1.dtype.kind == 'O':
        obj_column = col_1
        date_column = col_2
    else:
        obj_column = col_2
        date_column = col_1
    try:
        return pd.Series((pd.to_datetime(obj_column) == date_column) | obj_column.isnull() & date_column.isnull())
    except:
        return pd.Series(False, index=col_1.index)
```
</details>
<!---Documatic-block-datacompy.core.compare_string_and_date_columns-end--->
<!---Documatic-section-compare_string_and_date_columns-end--->

# #
<!---Documatic-section-datacompy.core.compare_string_and_date_columns-end--->

<!---Documatic-section-datacompy.core.get_merged_columns-start--->
## [datacompy.core.get_merged_columns](4-datacompy_core.md#datacompy.core.get_merged_columns)

<!---Documatic-section-get_merged_columns-start--->
<!---Documatic-block-datacompy.core.get_merged_columns-start--->
<details>
	<summary><code>datacompy.core.get_merged_columns</code> code snippet</summary>

```python
def get_merged_columns(original_df, merged_df, suffix):
    columns = []
    for col in original_df.columns:
        if col in merged_df.columns:
            columns.append(col)
        elif col + suffix in merged_df.columns:
            columns.append(col + suffix)
        else:
            raise ValueError('Column not found: %s', col)
    return columns
```
</details>
<!---Documatic-block-datacompy.core.get_merged_columns-end--->
<!---Documatic-section-get_merged_columns-end--->

# #
<!---Documatic-section-datacompy.core.get_merged_columns-end--->

<!---Documatic-section-datacompy.core.temp_column_name-start--->
## [datacompy.core.temp_column_name](4-datacompy_core.md#datacompy.core.temp_column_name)

<!---Documatic-section-temp_column_name-start--->
<!---Documatic-block-datacompy.core.temp_column_name-start--->
<details>
	<summary><code>datacompy.core.temp_column_name</code> code snippet</summary>

```python
def temp_column_name(*dataframes):
    i = 0
    while True:
        temp_column = '_temp_{}'.format(i)
        unique = True
        for dataframe in dataframes:
            if temp_column in dataframe.columns:
                i += 1
                unique = False
        if unique:
            return temp_column
```
</details>
<!---Documatic-block-datacompy.core.temp_column_name-end--->
<!---Documatic-section-temp_column_name-end--->

# #
<!---Documatic-section-datacompy.core.temp_column_name-end--->

<!---Documatic-section-datacompy.core.calculate_max_diff-start--->
## [datacompy.core.calculate_max_diff](4-datacompy_core.md#datacompy.core.calculate_max_diff)

<!---Documatic-section-calculate_max_diff-start--->
<!---Documatic-block-datacompy.core.calculate_max_diff-start--->
<details>
	<summary><code>datacompy.core.calculate_max_diff</code> code snippet</summary>

```python
def calculate_max_diff(col_1, col_2):
    try:
        return (col_1.astype(float) - col_2.astype(float)).abs().max()
    except:
        return 0
```
</details>
<!---Documatic-block-datacompy.core.calculate_max_diff-end--->
<!---Documatic-section-calculate_max_diff-end--->

# #
<!---Documatic-section-datacompy.core.calculate_max_diff-end--->

<!---Documatic-section-datacompy.core.generate_id_within_group-start--->
## [datacompy.core.generate_id_within_group](4-datacompy_core.md#datacompy.core.generate_id_within_group)

<!---Documatic-section-generate_id_within_group-start--->
<!---Documatic-block-datacompy.core.generate_id_within_group-start--->
<details>
	<summary><code>datacompy.core.generate_id_within_group</code> code snippet</summary>

```python
def generate_id_within_group(dataframe, join_columns):
    default_value = 'DATACOMPY_NULL'
    if dataframe[join_columns].isnull().any().any():
        if (dataframe[join_columns] == default_value).any().any():
            raise ValueError('{} was found in your join columns'.format(default_value))
        return dataframe[join_columns].astype(str).fillna(default_value).groupby(join_columns).cumcount()
    else:
        return dataframe[join_columns].groupby(join_columns).cumcount()
```
</details>
<!---Documatic-block-datacompy.core.generate_id_within_group-end--->
<!---Documatic-section-generate_id_within_group-end--->

# #
<!---Documatic-section-datacompy.core.generate_id_within_group-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)